# 🧾 《AI美食大师》项目需求文档（PRD）

## 文档信息

| 项目 | 内容         |
|------|------------|
| **文档版本** | v1.0       |
| **创建日期** | 2025-10-20 |
| **最后更新** | 2025-11-11 |
| **文档状态** | 完成         |
| **产品负责人** | 张圣杰        |
| **技术负责人** | 檀子彤        |
| **目标上线日期** | 2025/11/11 |

---

## 修订历史

| 版本 | 日期 | 修订人 | 修订内容   |
|------|------|--------|--------|
| v1.0 | 2025-11-11 | - | 最终版本创建 |

---

## 一、项目概述

### 1.1 项目名称

**AI美食大师（AI Master Chef）**

### 1.2 项目简介

AI美食大师是一款基于大语言模型的智能菜谱生成平台，用户可通过输入食材、菜系偏好或关键词，快速获得专业菜谱、营养分析、酒水推荐、调味方案与菜品图像。平台结合 AI 技术与中华饮食文化，支持个性化饮食推荐与创意料理生成，帮助用户提升饮食健康与烹饪体验。

### 1.3 开发背景与目标

#### 1.3.1 背景分析

传统菜谱平台仅能提供静态内容，缺乏灵活交互与个性化推荐。主要痛点包括：
- 用户需要在海量菜谱中手动筛选，效率低下
- 缺乏根据现有食材的智能推荐能力
- 营养信息不完善，难以支持健康饮食规划
- 缺少个性化的口味适配和创意启发

#### 1.3.2 项目目标

AI美食大师旨在：

* **核心目标**：利用AI生成技术自动化生成菜谱与配图，提供智能化烹饪解决方案
* **差异化价值**：融合营养健康分析与文化特色，提供个性化饮食体验
* **技术目标**：构建用户可控的 AI 模型配置系统
* **平台定位**：打造多模型接入的开放式美食内容生成平台

#### 1.3.3 目标用户画像

| 用户类型 | 特征描述 | 核心需求 |
|----------|----------|----------|
| 烹饪新手 | 缺乏烹饪经验，希望快速上手 | 详细步骤指导、基础菜谱推荐 |
| 家庭主妇/主夫 | 每日负责家庭饮食，追求营养均衡 | 营养分析、食材利用、快速菜谱 |
| 美食爱好者 | 喜欢尝试新菜品，追求创意 | 创意料理、多样化菜系、特色搭配 |
| 健身/健康人群 | 注重卡路里和营养摄入 | 精准营养数据、健康菜谱筛选 |
| AI技术爱好者 | 对AI应用感兴趣 | 模型配置、技术探索 |

#### 1.3.4 成功指标

| 指标类型 | 具体指标 | 目标值 |
|----------|----------|--------|
| 用户指标 | 月活跃用户数 | 第一季度达到1000+ |
| 使用指标 | 日均菜谱生成次数 | 500+ |
| 留存指标 | 7日留存率 | ≥40% |
| 满意度指标 | 用户满意度评分 | ≥4.0/5.0 |
| 技术指标 | AI生成成功率 | ≥95% |

---

## 二、功能需求说明

### 2.1 核心功能模块

| 模块 | 功能描述 | 用户操作 | 输出结果 | 优先级 |
|------|----------|----------|----------|--------|
| 🧠 智能菜谱生成 | 根据输入的食材、菜系、口味偏好生成详细菜谱 | 用户输入或选择食材与菜系 | AI输出菜名、步骤、食材表 | P0 |
| 🧬 营养分析 | 自动分析菜谱的营养成分（如热量、蛋白质、脂肪等） | 菜谱生成后系统自动分析 | 展示营养表与健康评分 | P0 |
| 🎨 AI效果图生成 | 根据菜谱生成菜品图像 | 一键生成 | 展示菜品图片 | P0 |
| 🍷 酒水推荐 | 根据菜系与口味自动推荐搭配酒水 | 菜谱生成后自动生成推荐 | 推荐饮品及解释说明 | P1 |
| 🧂 酱汁设计 | 为菜品定制个性化酱汁配方 | 用户点击"生成酱汁" | 输出配料比例与制作步骤 | P1 |
| 💾 收藏管理 | 保存、浏览和删除收藏的菜谱 | 收藏/取消收藏 | 收藏夹页面展示 | P0 |
| 🔮 料理占卜 | 趣味功能，根据今日运势生成"今日之菜" | 用户点击"占卜"按钮 | 输出随机菜谱及运势说明 | P2 |

**优先级说明：**
- P0：核心功能，必须实现
- P1：重要功能，首版尽量实现
- P2：增值功能，可迭代优化

---

### 2.2 功能详细说明

#### 2.2.1 智能菜谱生成

**功能描述：**
用户通过输入食材、选择菜系或输入关键词，AI自动生成完整的菜谱内容。

**输入参数：**
- 食材列表（必填，支持多选）
- 菜系选择（可选：川菜、粤菜、湘菜、鲁菜、淮扬菜、闽菜、徽菜、浙菜、西餐、日料等）
- 口味偏好（可选：清淡、中辣、麻辣、香甜、酸爽等）
- 烹饪时间限制（可选：15分钟、30分钟、1小时等）
- 难度等级（可选：简单、中等、困难）

**输出内容：**
- 菜品名称
- 所需食材清单（含用量）
- 详细烹饪步骤（分步骤编号）
- 预计烹饪时间
- 难度等级
- 菜品特色说明

**业务规则：**
- 用户至少需输入1种食材才能生成
- AI应根据食材合理性进行提示（如食材搭配不当）
- 生成失败时提供重试机制，最多重试3次

**异常处理：**
- API调用失败：显示友好错误提示，提供"重新生成"按钮
- 超时处理：30秒超时，提示用户检查网络或配置
- 食材不足：提示用户至少输入1种食材

---

#### 2.2.2 营养分析

**功能描述：**
基于生成的菜谱，自动计算营养成分并提供健康建议。

**分析维度：**
- 总热量（千卡）
- 蛋白质（克）
- 脂肪（克）
- 碳水化合物（克）
- 膳食纤维（克）
- 钠含量（毫克）

**输出形式：**
- 营养成分表格
- 健康评分（1-10分）
- 饮食建议（如"适合减脂人群"、"钠含量偏高，高血压患者慎食"）

**计算逻辑：**
- 基于食材数据库中的标准营养数据
- 根据食材用量按比例计算
- AI生成健康评价与建议

---

#### 2.2.3 AI效果图生成

**功能描述：**
根据菜谱描述，调用图像生成API创建逼真的菜品图片。

**输入：**
- 菜品名称
- 菜品描述（由AI自动生成）
- 菜系风格（影响摆盘风格）

**输出：**
- 高清菜品图片（建议尺寸：1024x1024）
- 支持重新生成（更换图片风格）

**生成参数：**
- 图片质量：高清
- 风格：写实、食欲感强
- 背景：简洁餐桌或中式/西式餐具背景

---

#### 2.2.4 酒水推荐

**功能描述：**
根据菜系、口味自动推荐搭配的酒水饮品。

**推荐维度：**
- 酒类（白酒、红酒、啤酒、黄酒、清酒等）
- 饮料（茶饮、果汁、咖啡等）
- 配对理由说明

**输出示例：**
```
🍷 推荐酒水：干红葡萄酒
📝 推荐理由：西冷牛排的浓郁口感与干红的单宁完美融合，提升肉质香气。
```

---

#### 2.2.5 酱汁设计

**功能描述：**
为菜品定制特色酱汁配方。

**生成内容：**
- 酱汁名称
- 所需调料清单（含比例）
- 制作步骤
- 适用场景说明

**应用场景：**
- 烧烤酱汁
- 凉拌调料
- 蘸料设计
- 特色风味酱

---

#### 2.2.6 收藏管理

**功能描述：**
用户可将喜欢的菜谱收藏，方便后续查看。

**功能操作：**
- 收藏菜谱：点击❤️图标
- 取消收藏：再次点击已收藏的❤️图标
- 查看收藏：进入"我的收藏"页面
- 批量删除：支持多选删除

**存储方式：**
- 使用LocalStorage本地存储
- 数据结构：JSON格式，包含菜谱完整信息

**数据结构示例：**
```json
{
  "id": "recipe_20251111_001",
  "name": "宫保鸡丁",
  "ingredients": [...],
  "steps": [...],
  "image": "base64_or_url",
  "timestamp": 1699699200000
}
```

---

#### 2.2.7 料理占卜

**功能描述：**
趣味性功能，结合运势元素生成"今日推荐菜品"。

**生成逻辑：**
- 随机选择菜系与风格
- 生成趣味性运势说明（如"今日适合品尝麻辣川菜，火气冲天好运来"）
- 展示菜谱与运势卡片

**应用场景：**
- 用户不知道吃什么时的趣味引导
- 增加产品趣味性与用户粘性

---

#### 2.2.8 动态配置管理

**功能描述：**
允许用户自定义AI模型配置，包括API密钥、模型选择等。

**配置项详情：**

| 配置项 | 说明 | 默认值 | 是否必填 |
|--------|------|--------|----------|
| 文本生成API地址 | OpenAI兼容接口地址 | 302.AI地址 | 是 |
| 文本生成API密钥 | 用于认证的密钥 | 环境变量值 | 是 |
| 文本生成模型 | 模型名称 | gpt-4 | 是 |
| 温度参数 | 控制创造性(0-1) | 0.7 | 否 |
| 超时时间 | 请求超时(毫秒) | 30000 | 否 |
| 图片生成API地址 | 图像生成接口地址 | 智谱AI地址 | 是 |
| 图片生成API密钥 | 图像API密钥 | 环境变量值 | 是 |
| 图片生成模型 | 图像模型名称 | cogview-3 | 是 |


---

### 2.3 动态配置系统

#### 2.3.1 系统特性

| 功能项 | 描述 |
|--------|------|
| 实时配置 | 用户修改模型参数后立即生效 |
| 持久化存储 | 配置信息保存到LocalStorage |
| 模型独立管理 | 文本生成与图片生成模型可分离配置 |
| API连接验证 | 可测试API密钥与连接有效性 |
| 一键恢复默认 | 恢复至.env默认配置 |

#### 2.3.2 支持配置项

**文本生成配置：**
- `base_url`：API服务地址
- `api_key`：认证密钥
- `model`：模型名称
- `temperature`：创造性参数(0-1)
- `timeout`：超时时间(ms)

**图片生成配置：**
- `base_url`：API服务地址
- `api_key`：认证密钥
- `model`：模型名称

---

### 2.4 AI生成逻辑

#### 2.4.1 模型调用策略

| 模块 | AI调用方式 | 说明 |
|------|-----------|------|
| 文本生成（菜谱、酱汁、酒水） | 使用 `VITE_TEXT_GENERATION_*` 环境变量 | 基于 302.AI 提供的 OpenAI 兼容接口 |
| 图片生成（菜品图） | 使用 `VITE_IMAGE_GENERATION_*` 环境变量 | 支持多厂商API（智谱、302AI等） |
| 模型切换 | 实时配置切换 | 通过 `settings.js` 管理状态并调用 API 工具 |

#### 2.4.2 提示词（Prompt）策略

**菜谱生成提示词结构：**
```
你是一位专业的中餐厨师，请根据以下信息生成一份详细菜谱：
- 食材：{用户输入的食材}
- 菜系：{选择的菜系}
- 口味：{口味偏好}
- 时间限制：{烹饪时间}

请按照以下格式输出：
1. 菜品名称
2. 所需食材清单（含用量）
3. 详细烹饪步骤
4. 预计烹饪时间
5. 难度等级
6. 菜品特色说明
```

**图片生成提示词结构：**
```
A professional food photography of {菜品名称}, {菜系} cuisine style, beautifully plated on a {餐具类型}, natural lighting, appetizing, high resolution, realistic, food photography
```

#### 2.4.3 错误处理与重试机制

| 错误类型 | 处理策略 |
|----------|----------|
| API调用超时 | 自动重试1次，失败后提示用户 |
| 密钥无效 | 提示用户检查配置 |
| 模型不可用 | 建议用户切换其他模型 |
| 内容生成失败 | 提供重新生成按钮 |
| 网络错误 | 提示检查网络连接 |

---

## 三、系统架构设计

### 3.1 技术栈

#### 3.1.1 前端技术

| 技术 | 版本 | 用途 |
|------|------|------|
| Vue | 3.4+ | 前端框架 |
| TypeScript | 5.3+ | 类型安全 |
| Tailwind CSS | 3.4+ | 样式框架 |
| Vite | 5.0+ | 构建工具 |
| Pinia | 2.1+ | 状态管理 |

#### 3.1.2 AI服务

| 服务商 | 用途 | 备选方案 |
|--------|------|----------|
| 302.AI | 文本生成（主） | OpenAI, Claude |
| 智谱AI | 图片生成 | DALL-E, Midjourney API |

#### 3.1.3 部署平台

- **主要平台：** Vercel
- **备选平台：** Netlify
- **CDN：** Cloudflare（可选）

---

### 3.2 系统结构图

```
┌─────────────────────────────────────────────────────────┐
│                      用户界面 (Vue)                        │
├─────────────────────────────────────────────────────────┤
│                                                           │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │  菜谱生成页   │  │   收藏管理   │  │   设置页面   │  │
│  │ RecipeGen.vue│  │ Favorites.vue│  │ Settings.vue │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
│                                                           │
├─────────────────────────────────────────────────────────┤
│                    组件层 (components/)                    │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │ RecipeCard   │  │ Nutrition    │  │SettingsModal │  │
│  │    .vue      │  │ Analysis.vue │  │    .vue      │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
├─────────────────────────────────────────────────────────┤
│                   状态管理 (stores/)                       │
│  ┌──────────────┐  ┌──────────────┐                     │
│  │ settings.js  │  │ recipes.js   │                     │
│  │ (配置管理)    │  │ (菜谱状态)    │                     │
│  └──────────────┘  └──────────────┘                     │
├─────────────────────────────────────────────────────────┤
│                   服务层 (services/)                       │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │ aiService.ts │  │ imageService │  │ favorite     │  │
│  │ (菜谱生成)    │  │     .ts      │  │ Service.ts   │  │
│  │              │  │ (图片生成)    │  │ (收藏管理)    │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
├─────────────────────────────────────────────────────────┤
│                   工具层 (utils/)                          │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │ apiConfig.js │  │ storage.js   │  │ validators.js│  │
│  │ (API配置)     │  │ (本地存储)    │  │ (数据验证)    │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
└─────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────┐
│                      外部服务                              │
│  ┌──────────────┐  ┌──────────────┐                     │
│  │  302.AI API  │  │ 智谱AI API    │                     │
│  │  (文本生成)   │  │  (图片生成)   │                     │
│  └──────────────┘  └──────────────┘                     │
└─────────────────────────────────────────────────────────┘
```

---

### 3.3 数据流设计

#### 3.3.1 菜谱生成流程

```
用户输入 → 前端验证 → 组装Prompt → 
调用AI API → 解析响应 → 营养分析 → 
生成图片 → 渲染展示 → 本地缓存
```

#### 3.3.2 配置更新流程

```
用户修改配置 → 前端验证 → 保存到Store → 
持久化到LocalStorage → 更新API客户端 → 
测试连接 → 反馈结果
```

---

### 3.4 目录结构

```
ai-master-chef/
├── src/
│   ├── assets/          # 静态资源
│   ├── components/      # 可复用组件
│   │   ├── RecipeCard.vue
│   │   ├── NutritionAnalysis.vue
│   │   ├── SettingsModal.vue
│   │   └── ...
│   ├── views/           # 页面级组件
│   │   ├── Home.vue
│   │   ├── Favorites.vue
│   │   └── Settings.vue
│   ├── services/        # 业务逻辑层
│   │   ├── aiService.ts
│   │   ├── imageService.ts
│   │   └── favoriteService.ts
│   ├── stores/          # 状态管理
│   │   ├── settings.js
│   │   └── recipes.js
│   ├── utils/           # 工具函数
│   │   ├── apiConfig.js
│   │   ├── storage.js
│   │   └── validators.js
│   ├── types/           # TypeScript类型定义
│   │   └── index.ts
│   ├── router/          # 路由配置
│   │   └── index.ts
│   ├── App.vue
│   └── main.ts
├── public/              # 公共静态资源
├── .env.example         # 环境变量示例
├── package.json
├── vite.config.ts
├── tailwind.config.js
└── tsconfig.json
```

---

## 四、非功能需求

### 4.1 性能要求

| 指标 | 目标值 | 说明 |
|------|--------|------|
| 页面加载时间 | < 2s | 首屏渲染时间（正常网络） |
| AI文本生成响应时间 | < 5s | 从请求到返回完整内容 |
| AI图片生成响应时间 | < 15s | 生成1024x1024图片 |
| 并发处理能力 | 100+ | 同时在线用户数 |
| 静态资源加载 | < 1s | CSS/JS 文件加载完成 |

**优化策略：**
- 代码分割与懒加载
- 图片压缩与CDN加速
- API响应缓存
- 骨架屏加载占位

---

### 4.2 安全性要求

| 安全措施 | 实施方案 |
|----------|----------|
| API密钥保护 | 前端加密存储，不明文传输 |
| XSS防护 | Vue自动转义，禁止innerHTML直接渲染用户输入 |
| CSRF防护 | API调用添加Token验证 |
| 敏感数据保护 | LocalStorage数据加密 |
| HTTPS强制 | 生产环境强制HTTPS |
| 输入验证 | 前后端双重验证 |

**安全检查清单：**
- [ ] API密钥不出现在代码仓库
- [ ] 用户输入经过XSS过滤
- [ ] 配置数据本地加密存储
- [ ] 第三方依赖定期安全审计

---

### 4.3 可扩展性要求

**设计原则：**
- **模块化设计**：各功能模块独立，低耦合
- **插件化架构**：支持增加新的AI服务商
- **配置化管理**：通过配置文件扩展功能
- **API版本管理**：支持多版本API共存

**扩展点：**
- 新增AI服务商接入
- 增加菜系分类
- 扩展营养分析维度
- 增加用户系统（未来）

---

### 4.4 可维护性要求

| 维度 | 要求 |
|------|------|
| 代码规范 | 遵循ESLint + Prettier规范 |
| 注释覆盖率 | 核心函数必须有注释 |
| 单元测试 | 核心业务逻辑覆盖率 > 60% |
| 文档完整性 | README + API文档 + 部署文档 |
| 版本控制 | 使用Git，遵循语义化版本号 |
| 日志记录 | 关键操作记录日志 |

---

### 4.5 可用性要求

**界面友好性：**
- 遵循Material Design或Ant Design设计规范
- 响应式设计，适配移动端、平板、桌面端
- 交互反馈及时（加载动画、操作提示）
- 错误提示清晰友好

**国际化支持：**
- 初期支持中文
- 预留多语言扩展接口
- 后续支持英文、日文等

**无障碍设计：**
- 支持键盘导航
- 图片添加alt描述
- 色彩对比度符合WCAG 2.0标准

---

### 4.6 兼容性要求

#### 4.6.1 浏览器兼容性

| 浏览器 | 最低版本 | 支持程度 |
|--------|----------|----------|
| Chrome | 最新版 | 完全支持 |
| Edge | 最新版 | 完全支持 |
| Safari | 最新版 | 完全支持 |
| Firefox | 最新版 | 完全支持 |
| 移动端浏览器 | iOS Safari 14+, Chrome Mobile | 完全支持 |

**不支持：** IE11及以下版本

#### 4.6.2 设备兼容性

| 设备类型 | 分辨率范围 | 适配方案 |
|----------|-----------|----------|
| 桌面端 | 1920x1080及以上 | 标准布局 |
| 笔记本 | 1366x768 - 1920x1080 | 响应式布局 |
| 平板 | 768x1024 | 自适应布局 |
| 手机 | 375x667 - 428x926 | 移动端优化布局 |

---

### 4.7 部署要求

**部署平台：**
- **主平台：** Vercel（推荐）
- **备选：** Netlify, GitHub Pages

**部署特性：**
- 支持一键部署
- 自动CI/CD
- 环境变量配置
- 域名绑定支持
- HTTPS自动配置

**环境要求：**
- Node.js 18+
- npm 9+ 或 yarn 1.22+

---

## 五、用户交互流程

### 5.1 智能菜谱生成流程

```
┌─────────────────┐
│  用户打开应用     │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 输入食材/菜系     │
│ (至少1种食材)     │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  点击"生成"按钮   │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  前端数据验证     │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 显示加载动画      │
│ "AI正在生成中..." │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 调用AI生成菜谱    │
│ (文本生成API)     │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 返回菜谱数据      │
│ (菜名/步骤/食材)  │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  自动营养分析     │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 调用图片生成API   │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 显示完整菜谱卡片  │
│ (文字+图片+营养)  │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 用户可选操作：    │
│ • 收藏           │
│ • 生成酱汁       │
│ • 查看酒水推荐    │
│ • 重新生成       │
└─────────────────┘
```

**异常流程：**
- API调用失败 → 显示错误提示 → 提供"重试"按钮
- 超时 → 提示用户检查网络 → 提供"取消"和"重试"选项
- 食材不合理 → AI提示建议 → 用户修改输入

---

**备选操作：**
- 点击"恢复默认" → 确认弹窗 → 重置为.env配置
- 点击"取消" → 不保存更改 → 关闭面板

---

### 5.3 收藏菜谱流程

```
┌─────────────────┐
│ 浏览生成的菜谱    │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 点击❤️收藏按钮    │
└────────┬────────┘
         │
         ▼
    ┌────┴────┐
    │         │
    ▼         ▼
┌────────┐ ┌────────┐
│未收藏  │ │已收藏  │
└───┬────┘ └───┬────┘
    │          │
    ▼          ▼
┌────────┐ ┌────────┐
│添加收藏│ │取消收藏│
└───┬────┘ └───┬────┘
    │          │
    └────┬─────┘
         │
         ▼
┌─────────────────┐
│ 保存到LocalStorage│
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 更新UI状态       │
│ (按钮变色)        │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 显示Toast提示    │
│ "已收藏/已取消"   │
└─────────────────┘

═══════════════════════

查看收藏流程：

┌─────────────────┐
│ 点击"我的收藏"    │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 从Storage读取数据 │
└────────┬────────┘
         │
         ▼
    ┌────┴────┐
    │         │
    ▼         ▼
┌────────┐ ┌────────┐
│有数据  │ │无数据  │
└───┬────┘ └───┬────┘
    │          │
    ▼          ▼
┌────────┐ ┌────────┐
│展示列表│ │空状态页│
└───┬────┘ └────────┘
    │
    ▼
┌─────────────────┐
│ 可执行操作：      │
│ • 查看详情       │
│ • 取消收藏       │
│ • 批量删除       │
└─────────────────┘
```

---

### 5.4 料理占卜流程

```
┌─────────────────┐
│ 点击"料理占卜"    │
│ 按钮🔮           │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 显示占卜动画      │
│ (水晶球/抽卡特效) │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 随机生成菜系      │
│ + 运势文案       │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 调用AI生成菜谱    │
│ (基于随机菜系)    │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 展示占卜结果      │
│ • 今日运势       │
│ • 推荐菜品       │
│ • 运势说明       │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 用户可选操作：    │
│ • 接受推荐       │
│ • 重新占卜       │
│ • 收藏该菜谱     │
└─────────────────┘
```

---

## 六、接口与环境变量说明

### 6.1 环境变量清单

| 环境变量 | 说明 | 示例值                                    | 必填 |
|---------|------|----------------------------------------|------|
| `VITE_TEXT_GENERATION_BASE_URL` | 文本生成API地址 | `https://api.302.ai/v1`                | 是 |
| `VITE_TEXT_GENERATION_API_KEY` | 文本生成API密钥 | `sk-xxxxxxxxxxxx`                      | 是 |
| `VITE_TEXT_GENERATION_MODEL` | 文本生成模型名称 | `doubao`                               | 是 |
| `VITE_TEXT_GENERATION_TEMPERATURE` | 创造性参数 (0-1) | `0.7`                                  | 否 |
| `VITE_TEXT_GENERATION_TIMEOUT` | 请求超时时间 (ms) | `30000`                                | 否 |
| `VITE_IMAGE_GENERATION_BASE_URL` | 图片生成API地址 | `https://open.bigmodel.cn/api/paas/v4` | 是 |
| `VITE_IMAGE_GENERATION_API_KEY` | 图片生成API密钥 | `xxxxxxxxxxxxxxxx`                     | 是 |
| `VITE_IMAGE_GENERATION_MODEL` | 图片生成模型名称 | `cogview-3`                            | 是 |

### 6.2 .env 文件示例

```bash
# 文本生成配置 (302.AI)
VITE_TEXT_GENERATION_BASE_URL=https://api.302.ai/v1
VITE_TEXT_GENERATION_API_KEY=your_302ai_api_key_here
VITE_TEXT_GENERATION_MODEL=gpt-4
VITE_TEXT_GENERATION_TEMPERATURE=0.7
VITE_TEXT_GENERATION_TIMEOUT=30000

# 图片生成配置 (智谱AI)
VITE_IMAGE_GENERATION_BASE_URL=https://open.bigmodel.cn/api/paas/v4
VITE_IMAGE_GENERATION_API_KEY=your_zhipu_api_key_here
VITE_IMAGE_GENERATION_MODEL=cogview-3
```

---

### 6.3 API接口规范

#### 6.3.1 文本生成接口

**请求格式（OpenAI兼容）：**

```http
POST {BASE_URL}/chat/completions
Content-Type: application/json
Authorization: Bearer {API_KEY}

{
  "model": "gpt-4",
  "messages": [
    {
      "role": "system",
      "content": "你是一位专业的中餐厨师"
    },
    {
      "role": "user",
      "content": "请根据鸡肉、土豆生成一道川菜"
    }
  ],
  "temperature": 0.7,
  "max_tokens": 2000
}
```

**响应格式：**

```json
{
  "id": "chatcmpl-xxxxx",
  "object": "chat.completion",
  "created": 1699699200,
  "model": "gpt-4",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "菜名：麻辣鸡丁土豆\n\n食材清单：\n- 鸡胸肉 300g\n- 土豆 2个\n..."
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 50,
    "completion_tokens": 300,
    "total_tokens": 350
  }
}
```

---

#### 6.3.2 图片生成接口

**请求格式（智谱AI）：**

```http
POST {BASE_URL}/images/generations
Content-Type: application/json
Authorization: Bearer {API_KEY}

{
  "model": "cogview-3",
  "prompt": "A professional food photography of 麻辣鸡丁土豆, Sichuan cuisine style, beautifully plated, natural lighting",
  "size": "1024x1024",
  "n": 1
}
```

**响应格式：**

```json
{
  "created": 1699699200,
  "data": [
    {
      "url": "https://example.com/image.png"
    }
  ]
}
```

---

### 6.4 错误码说明

| 错误码 | 说明 | 处理方式 |
|-------|------|----------|
| 401 | API密钥无效 | 提示用户检查配置 |
| 429 | 请求频率超限 | 稍后重试，显示限流提示 |
| 500 | 服务器错误 | 自动重试1次 |
| 503 | 服务不可用 | 提示用户稍后再试 |
| timeout | 请求超时 | 提示用户检查网络 |

---

## 七、数据存储设计

### 7.1 LocalStorage 数据结构

#### 7.1.1 用户配置

**Key:** `ai_chef_settings`

```json
{
  "textGeneration": {
    "baseUrl": "https://api.302.ai/v1",
    "apiKey": "encrypted_key_string",
    "model": "gpt-4",
    "temperature": 0.7,
    "timeout": 30000
  },
  "imageGeneration": {
    "baseUrl": "https://open.bigmodel.cn/api/paas/v4",
    "apiKey": "encrypted_key_string",
    "model": "cogview-3"
  },
  "lastModified": 1699699200000
}
```

---

#### 7.1.2 收藏菜谱

**Key:** `ai_chef_favorites`

```json
[
  {
    "id": "recipe_20251111_001",
    "name": "宫保鸡丁",
    "cuisine": "川菜",
    "ingredients": [
      { "name": "鸡胸肉", "amount": "300g" },
      { "name": "花生米", "amount": "50g" }
    ],
    "steps": [
      "步骤1：鸡肉切丁，用料酒和淀粉腌制15分钟",
      "步骤2：热锅冷油，爆香花椒..."
    ],
    "nutrition": {
      "calories": 450,
      "protein": 35,
      "fat": 18,
      "carbs": 25
    },
    "image": "https://example.com/image.png",
    "createdAt": 1699699200000,
    "favoritedAt": 1699699300000
  }
]
```

---

#### 7.1.3 生成历史（可选）

**Key:** `ai_chef_history`

```json
{
  "recipes": [
    {
      "id": "history_001",
      "name": "红烧肉",
      "timestamp": 1699699200000,
      "isFavorited": false
    }
  ],
  "maxSize": 50
}
```

---

### 7.2 数据管理策略

| 策略 | 说明 |
|------|------|
| 数据加密 | API密钥使用AES加密存储 |
| 容量限制 | 收藏上限100条，超出时提示用户清理 |
| 数据清理 | 提供"清空历史"和"清空收藏"功能 |
| 数据导出 | 支持导出收藏为JSON文件 |
| 数据导入 | 支持导入JSON格式的收藏数据 |

---

## 八、测试计划

### 8.1 测试范围

| 测试类型 | 覆盖范围 |
|----------|----------|
| 单元测试 | 核心业务逻辑函数 |
| 集成测试 | API调用与数据流转 |
| UI测试 | 组件渲染与交互 |
| 端到端测试 | 完整用户流程 |
| 性能测试 | 加载速度与响应时间 |
| 兼容性测试 | 多浏览器与设备测试 |

---

### 8.2 测试用例（示例）

#### 8.2.1 菜谱生成测试

| 用例ID | 测试场景 | 预期结果 |
|--------|----------|----------|
| TC001 | 输入单个食材生成菜谱 | 成功生成完整菜谱 |
| TC002 | 输入多个食材生成菜谱 | 成功生成包含所有食材的菜谱 |
| TC003 | 不输入食材直接生成 | 显示错误提示 |
| TC004 | API调用失败 | 显示错误提示并提供重试 |
| TC005 | 生成超时 | 显示超时提示 |

---

#### 8.2.2 配置管理测试

| 用例ID | 测试场景 | 预期结果 |
|--------|----------|----------|
| TC101 | 修改API密钥并保存 | 配置更新成功，下次请求使用新密钥 |
| TC102 | 测试无效API密钥 | 显示连接失败提示 |
| TC103 | 恢复默认配置 | 所有配置恢复为.env初始值 |
| TC104 | 配置持久化验证 | 刷新页面后配置仍然保留 |

---

#### 8.2.3 收藏功能测试

| 用例ID | 测试场景 | 预期结果 |
|--------|----------|----------|
| TC201 | 收藏一道菜谱 | 收藏成功，图标变为已收藏状态 |
| TC202 | 取消收藏 | 取消成功，从收藏列表移除 |
| TC203 | 查看收藏列表 | 显示所有收藏的菜谱 |
| TC204 | 收藏上限测试 | 达到上限时提示用户 |

---

### 8.3 性能测试指标

| 测试项 | 指标 | 测试工具 |
|--------|------|----------|
| 首屏加载时间 | < 2s | Lighthouse |
| AI响应时间 | < 5s | 自定义计时 |
| 内存占用 | < 100MB | Chrome DevTools |
| 并发处理 | 100+ 用户 | Apache JMeter |

---

## 九、项目里程碑与交付计划

### 9.1 开发阶段划分

| 阶段 | 时间周期 | 主要任务 | 交付物 |
|------|----------|----------|--------|
| **需求评审** | 第1周 | PRD评审与确认 | 确认版PRD文档 |
| **设计阶段** | 第2周 | UI设计、技术方案设计 | UI设计稿、技术方案文档 |
| **开发阶段** | 第3-6周 | 功能开发与联调 | 可运行的Beta版本 |
| **测试阶段** | 第7周 | 功能测试、性能测试 | 测试报告 |
| **上线准备** | 第8周 | 部署、文档完善 | 生产环境上线 |
| **运营优化** | 持续 | 用户反馈收集与迭代 | 版本更新 |

---

### 9.2 版本规划

#### V1.0（MVP版本）- 预计第8周上线

**核心功能：**
- ✅ 智能菜谱生成
- ✅ 营养分析
- ✅ AI效果图生成
- ✅ 收藏管理
- ✅ 动态配置管理

**暂缓功能：**
- 🔄 酒水推荐（V1.1）
- 🔄 酱汁设计（V1.1）
- 🔄 料理占卜（V1.2）

---

#### V1.1 - 预计V1.0上线后4周

**新增功能：**
- 酒水推荐
- 酱汁设计
- 用户反馈收集

---

#### V1.2 - 预计V1.1后6周

**新增功能：**
- 料理占卜
- 生成历史记录
- 菜谱分享功能

---

### 9.3 交付标准

| 交付项 | 标准 |
|--------|------|
| 代码质量 | 通过ESLint检查，无Critical级别问题 |
| 功能完整性 | P0功能100%实现，P1功能≥80%实现 |
| 测试覆盖率 | 单元测试覆盖率≥60% |
| 性能达标 | 符合第四章性能要求 |
| 文档完整性 | README、API文档、部署文档齐全 |
| 部署验证 | 成功部署到生产环境并可访问 |

---

## 十、未来扩展方向

### 10.1 短期规划（3-6个月）

| 方向 | 描述 | 优先级 |
|------|------|--------|
| 🌍 多语言支持 | 增加英文界面，支持国际料理推荐 | 高 |
| 📱 移动端优化 | PWA支持，提升移动端体验 | 高 |
| 🍽️ 个性化推荐 | 基于用户历史生成偏好推荐 | 中 |
| 📊 数据统计 | 用户行为分析，热门菜谱排行 | 中 |

---

### 10.2 中期规划（6-12个月）

| 方向 | 描述 | 优先级 |
|------|------|--------|
| 🧑‍🍳 用户社区 | 用户上传自制菜谱，AI优化 | 高 |
| 🤖 AI助理 | 增强对话式烹饪指导 | 中 |
| 🎥 视频教学 | 集成烹饪视频推荐 | 低 |
| 🛒 食材购买 | 对接电商平台一键购买 | 低 |

---

### 10.3 长期规划（12个月+）

| 方向 | 描述 | 优先级 |
|------|------|--------|
| 🏥 健康管理 | 结合用户健康数据（血糖、血压）定制菜谱 | 高 |
| 🌐 多平台扩展 | 微信小程序、移动App | 中 |
| 🤝 商业合作 | 与厨具品牌、食材供应商合作 | 中 |
| 🎓 教育模式 | 烹饪课程与认证体系 | 低 |

---

## 十一、风险评估与应对

### 11.1 技术风险

| 风险 | 影响 | 概率 | 应对措施 |
|------|------|------|----------|
| AI服务不稳定 | 高 | 中 | 增加备用API服务商，实现自动切换 |
| API费用超预算 | 中 | 中 | 设置请求限额，优化Prompt减少Token消耗 |
| 浏览器兼容性问题 | 低 | 低 | 充分测试，提供降级方案 |
| 性能瓶颈 | 中 | 低 | 代码优化，CDN加速 |

---

### 11.2 业务风险

| 风险 | 影响 | 概率 | 应对措施 |
|------|------|------|----------|
| 用户留存率低 | 高 | 中 | 增加个性化功能，提升用户粘性 |
| 竞品压力 | 中 | 高 | 差异化定位，强化AI技术优势 |
| 数据安全问题 | 高 | 低 | 加强安全措施，用户数据加密 |
| 版权问题 | 中 | 低 | 确保AI生成内容原创性 |

---

### 11.3 资源风险

| 风险 | 影响 | 概率 | 应对措施 |
|------|------|------|----------|
| 开发人员不足 | 高 | 中 | 明确优先级，分阶段交付 |
| 时间延期 | 中 | 中 | 每周进度review，及时调整计划 |
| 预算不足 | 中 | 低 | 优先保证核心功能，削减非必要功能 |

---

## 十二、附录

### 12.1 术语表

| 术语 | 解释 |
|------|------|
| PRD | Product Requirements Document，产品需求文档 |
| MVP | Minimum Viable Product，最小可行产品 |
| API | Application Programming Interface，应用程序接口 |
| LLM | Large Language Model，大语言模型 |
| LocalStorage | 浏览器本地存储 |
| Token | API调用的计量单位 |
| Prompt | 提示词，用于引导AI生成内容 |

---

### 12.2 参考文档

- Vue 3 官方文档：https://vuejs.org/
- Tailwind CSS 文档：https://tailwindcss.com/
- 302.AI API 文档：https://302.ai/docs
- 智谱AI API 文档：https://open.bigmodel.cn/dev/api

---

